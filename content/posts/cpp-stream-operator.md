+++
title = 'ä¸ºä»€ä¹ˆ C++ ä½¿ç”¨æ’å…¥å’Œæå–è¿ç®—ç¬¦è€Œä¸æ˜¯å‡½æ•°ï¼Ÿ'
date = 2024-01-08T00:00:00+00:00
+++
https://www.reddit.com/r/cpp/comments/xbn04o/why_does_c_use_the_insertion_and_extraction/?tl=zh-hans

ä¸ºä»€ä¹ˆc++åœ¨æ‰“å°å­—ç¬¦ä¸²æ—¶ä½¿ç”¨æ’å…¥è¿ç®—ç¬¦<<ï¼Œè€Œä¸æ˜¯åƒcä¸€æ ·é€šè¿‡æŸä¸ªæ–¹æ³•æ¯”å¦‚printå®ç°ï¼Œæ˜¯å†å²é—ç•™é—®é¢˜è¿˜æ˜¯å‡ºäºæŸç§è€ƒè™‘ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼C++ä½¿ç”¨æ’å…¥è¿ç®—ç¬¦`<<`è€Œä¸æ˜¯ç±»ä¼¼Cçš„`printf`å‡½æ•°ï¼Œè¿™ç¡®å®æœ‰æ·±å±‚çš„è®¾è®¡è€ƒè™‘ï¼Œå¹¶éç®€å•çš„å†å²é—ç•™é—®é¢˜ã€‚è®©æˆ‘è¯¦ç»†è§£é‡Šï¼š

## ğŸ¯ è®¾è®¡å“²å­¦å·®å¼‚

### Cè¯­è¨€çš„å‡½æ•°å¼æ–¹æ³•
```c
// Cè¯­è¨€æ–¹å¼ - å‡½æ•°è°ƒç”¨
printf("Hello %s, you are %d years old\n", name, age);
scanf("%d", &number);
```

### C++çš„é¢å‘å¯¹è±¡æ–¹æ³•
```cpp
// C++æ–¹å¼ - è¿ç®—ç¬¦é‡è½½
std::cout << "Hello " << name << ", you are " << age << " years old\n";
std::cin >> number;
```

## ğŸ” é€‰æ‹©`<<`è¿ç®—ç¬¦çš„æ ¸å¿ƒåŸå› 

### 1. **ç±»å‹å®‰å…¨ (Type Safety)**
```cpp
// Cè¯­è¨€ - ç±»å‹ä¸å®‰å…¨ï¼Œè¿è¡Œæ—¶é”™è¯¯
int age = 25;
printf("%s", age);  // ğŸ’€ æœªå®šä¹‰è¡Œä¸ºï¼Œç¼–è¯‘å™¨å¯èƒ½ä¸æŠ¥é”™

// C++ - ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
std::cout << age;   // âœ… ç¼–è¯‘å™¨ç¡®ä¿ç±»å‹åŒ¹é…
```

### 2. **è¿ç®—ç¬¦é‡è½½çš„è‡ªç„¶æ‰©å±•**
```cpp
// ä½ç§»è¿ç®—ç¬¦çš„åŸå§‹ç”¨é€”
int x = 8;
int result = x << 2;  // ä½å·¦ç§»ï¼Œresult = 32

// é‡è½½ä¸ºæµæ’å…¥è¿ç®—ç¬¦
std::cout << x;       // è¯­ä¹‰ä¸Š"å‘æµä¸­æ’å…¥æ•°æ®"
```

### 3. **é“¾å¼è°ƒç”¨çš„ä¼˜é›…æ€§**
```cpp
// Cè¯­è¨€éœ€è¦å¤šæ¬¡å‡½æ•°è°ƒç”¨
printf("Name: %s\n", name);
printf("Age: %d\n", age);
printf("Score: %.2f\n", score);

// C++å¯ä»¥é“¾å¼è°ƒç”¨
std::cout << "Name: " << name << "\n"
          << "Age: " << age << "\n" 
          << "Score: " << std::fixed << std::setprecision(2) << score << "\n";
```

### 4. **å¯æ‰©å±•æ€§**
```cpp
// è‡ªå®šä¹‰ç±»å‹å¯ä»¥é‡è½½<<è¿ç®—ç¬¦
class Person {
    std::string name;
    int age;
public:
    // é‡è½½è¾“å‡ºè¿ç®—ç¬¦
    friend std::ostream& operator<<(std::ostream& os, const Person& p) {
        return os << "Person{name: " << p.name << ", age: " << p.age << "}";
    }
};

Person p{"Alice", 30};
std::cout << p;  // ç›´æ¥è¾“å‡ºè‡ªå®šä¹‰å¯¹è±¡
```

## ğŸ—ï¸ å†å²èƒŒæ™¯

### Bjarne Stroustrupçš„è®¾è®¡å†³ç­–

1. **1980å¹´ä»£åˆæœŸ**ï¼šStroustrupåœ¨è®¾è®¡C++æ—¶ï¼Œå¸Œæœ›ä¿æŒCçš„æ•ˆç‡ä½†å¢åŠ é¢å‘å¯¹è±¡ç‰¹æ€§

2. **è¿ç®—ç¬¦é‡è½½å¼•å…¥**ï¼šä¸ºäº†è®©ç”¨æˆ·å®šä¹‰ç±»å‹èƒ½åƒå†…ç½®ç±»å‹ä¸€æ ·ä½¿ç”¨

3. **æµçš„æ¦‚å¿µ**ï¼šå—åˆ°Simulaå’Œå…¶ä»–è¯­è¨€å¯å‘ï¼Œè®¾è®¡äº†æµæŠ½è±¡

```cpp
// æ—©æœŸC++ (1985å¹´å·¦å³) çš„è®¾è®¡æ€è·¯
class ostream {
public:
    ostream& operator<<(int);
    ostream& operator<<(double);
    ostream& operator<<(const char*);
    // ... å…¶ä»–é‡è½½
};
```

## ğŸ’¡ è®¾è®¡ä¼˜åŠ¿è¯¦è§£

### 1. **ç¬¦åˆC++çš„æ“ä½œç¬¦å“²å­¦**
```cpp
// C++ä¸­æ“ä½œç¬¦åº”è¯¥å¯¹ç”¨æˆ·å®šä¹‰ç±»å‹å’Œå†…ç½®ç±»å‹ä¸€è‡´å·¥ä½œ
std::string s1 = "Hello";
std::string s2 = "World";
std::string s3 = s1 + s2;        // + è¿ç®—ç¬¦é‡è½½

std::complex<double> c1(1, 2);
std::complex<double> c2(3, 4);
std::complex<double> c3 = c1 + c2; // + è¿ç®—ç¬¦é‡è½½

std::cout << s3 << " " << c3;     // << è¿ç®—ç¬¦é‡è½½
```

### 2. **ç¼–è¯‘æ—¶å¤šæ€**
```cpp
template<typename T>
void print_value(const T& value) {
    std::cout << value;  // å¯¹ä»»ä½•æ”¯æŒ<<çš„ç±»å‹éƒ½æœ‰æ•ˆ
}

print_value(42);           // int
print_value(3.14);         // double
print_value("hello");      // const char*
print_value(std::string("world")); // std::string
```

### 3. **ä¸C++æµæ¨¡å‹å®Œç¾å¥‘åˆ**
```cpp
// æµçš„ç»Ÿä¸€æ¥å£
std::ofstream file("output.txt");
std::ostringstream ss;

// ç›¸åŒçš„è¯­æ³•é€‚ç”¨äºä¸åŒçš„æµ
std::cout << "Console output\n";
file << "File output\n";
ss << "String stream output\n";
```

## ğŸ†š å¯¹æ¯”å…¶ä»–è®¾è®¡é€‰æ‹©

### å¦‚æœC++é€‰æ‹©äº†å‡½æ•°å¼æ–¹æ³•
```cpp
// å‡è®¾çš„å‡½æ•°å¼è®¾è®¡
print("Hello", name, "you are", age, "years old");

// é—®é¢˜ï¼š
// 1. å¦‚ä½•å¤„ç†è‡ªå®šä¹‰ç±»å‹ï¼Ÿ
// 2. å¦‚ä½•ä¿è¯ç±»å‹å®‰å…¨ï¼Ÿ
// 3. å¦‚ä½•ä¸æµæ¨¡å‹é›†æˆï¼Ÿ
```

### Pythonç­‰è¯­è¨€çš„é€‰æ‹©
```python
# Pythoné€‰æ‹©äº†æ–¹æ³•è°ƒç”¨
print("Hello", name, "you are", age, "years old")

# ä½†Pythonæ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œè®¾è®¡ç›®æ ‡ä¸åŒ
```

## ğŸ”§ ç°ä»£C++çš„æ¼”è¿›

### C++20å¼•å…¥çš„std::format
```cpp
// C++20æä¾›äº†æ›´ç°ä»£çš„é€‰æ‹©
#include <format>

std::string result = std::format("Hello {}, you are {} years old", name, age);
std::cout << result;

// æˆ–è€…C++23çš„std::print
std::print("Hello {}, you are {} years old\n", name, age);
```

è¿™è¡¨æ˜C++ç¤¾åŒºä¹Ÿè®¤è¯†åˆ°äº†`printf`é£æ ¼çš„ä¼˜åŠ¿ï¼Œä½†é‡‡ç”¨äº†ç±»å‹å®‰å…¨çš„å®ç°ã€‚

## ğŸ­ è¯­ä¹‰æ„ä¹‰

### `<<` ç¬¦å·çš„è¯­ä¹‰å«ä¹‰
```cpp
// è§†è§‰ä¸Šçš„æ•°æ®æµå‘
data â†’ stream
std::cout << data;  // æ•°æ®"æµå‘"è¾“å‡ºæµ

// è¿™æ¯”å‡½æ•°è°ƒç”¨æ›´ç›´è§‚åœ°è¡¨è¾¾äº†æ•°æ®æµçš„æ¦‚å¿µ
print(data);        // ä¸å¤ªæ˜æ˜¾çš„æ•°æ®æµå‘
```

## ğŸ“ æ€»ç»“

C++é€‰æ‹©`<<`è¿ç®—ç¬¦è€Œéå‡½æ•°çš„åŸå› ï¼š

1. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
2. **è¿ç®—ç¬¦é‡è½½å“²å­¦**ï¼šè®©ç”¨æˆ·å®šä¹‰ç±»å‹èƒ½åƒå†…ç½®ç±»å‹ä¸€æ ·ä½¿ç”¨
3. **é“¾å¼è°ƒç”¨**ï¼šæ›´ä¼˜é›…çš„è¯­æ³•
4. **å¯æ‰©å±•æ€§**ï¼šæ˜“äºä¸ºæ–°ç±»å‹æ·»åŠ æ”¯æŒ
5. **ä¸æµæ¨¡å‹ä¸€è‡´**ï¼šç¬¦åˆC++çš„æŠ½è±¡è®¾è®¡
6. **è¯­ä¹‰æ¸…æ™°**ï¼šè§†è§‰ä¸Šè¡¨è¾¾æ•°æ®æµå‘

è¿™ä¸æ˜¯å†å²é—ç•™é—®é¢˜ï¼Œè€Œæ˜¯ç»è¿‡æ·±æ€ç†Ÿè™‘çš„è®¾è®¡å†³ç­–ï¼Œä½“ç°äº†C++ä½œä¸º"æ›´å¥½çš„C"å’Œé¢å‘å¯¹è±¡è¯­è¨€çš„è®¾è®¡å“²å­¦ã€‚ç°ä»£C++ï¼ˆC++20/23ï¼‰ä¸­å¼•å…¥`std::format`å’Œ`std::print`ï¼Œè¯´æ˜è¯­è¨€åœ¨ä¸æ–­æ¼”è¿›ï¼Œä½†`<<`è¿ç®—ç¬¦ä»ç„¶æ˜¯C++è¾“å‡ºçš„æ ¸å¿ƒæ–¹å¼ã€‚
